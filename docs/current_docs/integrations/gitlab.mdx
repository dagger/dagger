---
slug: /integrations/gitlab
---

# GitLab CI

## Authentication for Private Repositories

When working with private repositories in GitLab CI, see our [Git Credential Helpers Guide](/guides/ci/git-credential-helpers#gitlab) for authentication patterns. For private modules, refer to the [Remote Repositories documentation](/manuals/user/remote-repositories).

## Best Practices

When working with private repositories:
1. Start with a draft PR
2. Wait for confirmation before making the PR "ready for review"
3. Ignore CI and focus on local testing
4. Always rebase on main and force-push to the branch after each change

## Examples

```yaml title=".gitlab-ci.yml" file=./snippets/gitlab-docker-hello.yml
```

The following is a more complex example demonstrating how to create a GitLab pipeline that checks out source code, calls a Dagger Function to test the project, and then calls another Dagger Function to build and publish a container image of the project. This example uses a simple [Go application](https://github.com/kpenfound/greetings-api) and assumes that you have already forked it in your own GitLab repository.

```yaml title=".gitlab-ci.yml" file=./snippets/gitlab-docker-test-build.yml
```

### Kubernetes executor

The following example demonstrates how to call a Dagger Function in a GitLab CI/CD pipeline using the [Kubernetes executor](https://docs.gitlab.com/runner/executors/kubernetes/).

```yaml title=".gitlab-ci.yml" file=./snippets/gitlab-kubernetes-hello.yml
```

The following is a more complex example demonstrating how to create a GitLab pipeline that checks out source code, calls a Dagger Function to test the project, and then calls another Dagger Function to build and publish a container image of the project. This example uses a simple [Go application](https://github.com/kpenfound/greetings-api) and assumes that you have already forked it in your own GitLab repository.

```yaml title=".gitlab-ci.yml" file=./snippets/gitlab-kubernetes-test-build.yml
```

In both cases, each GitLab Runner must be configured to only run on nodes with pre-provisioned instances of the Dagger Engine. This is achieved using taints and tolerations on the nodes, and pod affinity.

The following code listings illustrate the configuration to be applied to each GitLab Runner, with taints, tolerations and pod affinity set via the `dagger-node` key. For an example of the corresponding node configuration, refer to the [OpenShift](./openshift.mdx) integration page.

To use this configuration, replace the YOUR-GITLAB-URL placeholder with the URL of your GitLab instance and replace the YOUR-GITLAB-RUNNER-TOKEN-REFERENCE placeholder with your [GitLab Runner authentication token](https://docs.gitlab.com/ee/ci/runners/runners_scope.html#create-a-shared-runner-with-a-runner-authentication-token).

```yaml title="runner-config.yml" file=./snippets/gitlab-runner-config.yml
```

```yaml title="runner.yml" file=./snippets/gitlab-runner.yml
```
