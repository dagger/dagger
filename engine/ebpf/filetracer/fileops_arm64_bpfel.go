// Code generated by bpf2go; DO NOT EDIT.
//go:build arm64

package filetracer

import (
	"bytes"
	_ "embed"
	"fmt"
	"io"

	"github.com/cilium/ebpf"
)

type fileopsKprobeCtx struct {
	StartNs uint64
	Op      uint32
	_       [4]byte
}

type fileopsSyscallCtx struct {
	StartNs uint64
	Op      uint32
	Flags   uint32
	Path    [128]int8
	Path2   [128]int8
}

// loadFileops returns the embedded CollectionSpec for fileops.
func loadFileops() (*ebpf.CollectionSpec, error) {
	reader := bytes.NewReader(_FileopsBytes)
	spec, err := ebpf.LoadCollectionSpecFromReader(reader)
	if err != nil {
		return nil, fmt.Errorf("can't load fileops: %w", err)
	}

	return spec, err
}

// loadFileopsObjects loads fileops and converts it into a struct.
//
// The following types are suitable as obj argument:
//
//	*fileopsObjects
//	*fileopsPrograms
//	*fileopsMaps
//
// See ebpf.CollectionSpec.LoadAndAssign documentation for details.
func loadFileopsObjects(obj interface{}, opts *ebpf.CollectionOptions) error {
	spec, err := loadFileops()
	if err != nil {
		return err
	}

	return spec.LoadAndAssign(obj, opts)
}

// fileopsSpecs contains maps and programs before they are loaded into the kernel.
//
// It can be passed ebpf.CollectionSpec.Assign.
type fileopsSpecs struct {
	fileopsProgramSpecs
	fileopsMapSpecs
	fileopsVariableSpecs
}

// fileopsProgramSpecs contains programs before they are loaded into the kernel.
//
// It can be passed ebpf.CollectionSpec.Assign.
type fileopsProgramSpecs struct {
	KpOvlWorkdirCleanup    *ebpf.ProgramSpec `ebpf:"kp_ovl_workdir_cleanup"`
	KpOvlWorkdirCreate     *ebpf.ProgramSpec `ebpf:"kp_ovl_workdir_create"`
	KpVfsMkdir             *ebpf.ProgramSpec `ebpf:"kp_vfs_mkdir"`
	KpVfsRmdir             *ebpf.ProgramSpec `ebpf:"kp_vfs_rmdir"`
	KretpOvlWorkdirCleanup *ebpf.ProgramSpec `ebpf:"kretp_ovl_workdir_cleanup"`
	KretpOvlWorkdirCreate  *ebpf.ProgramSpec `ebpf:"kretp_ovl_workdir_create"`
	KretpVfsMkdir          *ebpf.ProgramSpec `ebpf:"kretp_vfs_mkdir"`
	KretpVfsRmdir          *ebpf.ProgramSpec `ebpf:"kretp_vfs_rmdir"`
	TpSysEnterMkdirat      *ebpf.ProgramSpec `ebpf:"tp_sys_enter_mkdirat"`
	TpSysEnterMount        *ebpf.ProgramSpec `ebpf:"tp_sys_enter_mount"`
	TpSysEnterNewfstatat   *ebpf.ProgramSpec `ebpf:"tp_sys_enter_newfstatat"`
	TpSysEnterUmount       *ebpf.ProgramSpec `ebpf:"tp_sys_enter_umount"`
	TpSysEnterUnlinkat     *ebpf.ProgramSpec `ebpf:"tp_sys_enter_unlinkat"`
	TpSysExitMkdirat       *ebpf.ProgramSpec `ebpf:"tp_sys_exit_mkdirat"`
	TpSysExitMount         *ebpf.ProgramSpec `ebpf:"tp_sys_exit_mount"`
	TpSysExitNewfstatat    *ebpf.ProgramSpec `ebpf:"tp_sys_exit_newfstatat"`
	TpSysExitUmount        *ebpf.ProgramSpec `ebpf:"tp_sys_exit_umount"`
	TpSysExitUnlinkat      *ebpf.ProgramSpec `ebpf:"tp_sys_exit_unlinkat"`
}

// fileopsMapSpecs contains maps before they are loaded into the kernel.
//
// It can be passed ebpf.CollectionSpec.Assign.
type fileopsMapSpecs struct {
	Events        *ebpf.MapSpec `ebpf:"events"`
	KprobeCtxMap  *ebpf.MapSpec `ebpf:"kprobe_ctx_map"`
	SyscallCtxMap *ebpf.MapSpec `ebpf:"syscall_ctx_map"`
	TargetComm    *ebpf.MapSpec `ebpf:"target_comm"`
}

// fileopsVariableSpecs contains global variables before they are loaded into the kernel.
//
// It can be passed ebpf.CollectionSpec.Assign.
type fileopsVariableSpecs struct {
}

// fileopsObjects contains all objects after they have been loaded into the kernel.
//
// It can be passed to loadFileopsObjects or ebpf.CollectionSpec.LoadAndAssign.
type fileopsObjects struct {
	fileopsPrograms
	fileopsMaps
	fileopsVariables
}

func (o *fileopsObjects) Close() error {
	return _FileopsClose(
		&o.fileopsPrograms,
		&o.fileopsMaps,
	)
}

// fileopsMaps contains all maps after they have been loaded into the kernel.
//
// It can be passed to loadFileopsObjects or ebpf.CollectionSpec.LoadAndAssign.
type fileopsMaps struct {
	Events        *ebpf.Map `ebpf:"events"`
	KprobeCtxMap  *ebpf.Map `ebpf:"kprobe_ctx_map"`
	SyscallCtxMap *ebpf.Map `ebpf:"syscall_ctx_map"`
	TargetComm    *ebpf.Map `ebpf:"target_comm"`
}

func (m *fileopsMaps) Close() error {
	return _FileopsClose(
		m.Events,
		m.KprobeCtxMap,
		m.SyscallCtxMap,
		m.TargetComm,
	)
}

// fileopsVariables contains all global variables after they have been loaded into the kernel.
//
// It can be passed to loadFileopsObjects or ebpf.CollectionSpec.LoadAndAssign.
type fileopsVariables struct {
}

// fileopsPrograms contains all programs after they have been loaded into the kernel.
//
// It can be passed to loadFileopsObjects or ebpf.CollectionSpec.LoadAndAssign.
type fileopsPrograms struct {
	KpOvlWorkdirCleanup    *ebpf.Program `ebpf:"kp_ovl_workdir_cleanup"`
	KpOvlWorkdirCreate     *ebpf.Program `ebpf:"kp_ovl_workdir_create"`
	KpVfsMkdir             *ebpf.Program `ebpf:"kp_vfs_mkdir"`
	KpVfsRmdir             *ebpf.Program `ebpf:"kp_vfs_rmdir"`
	KretpOvlWorkdirCleanup *ebpf.Program `ebpf:"kretp_ovl_workdir_cleanup"`
	KretpOvlWorkdirCreate  *ebpf.Program `ebpf:"kretp_ovl_workdir_create"`
	KretpVfsMkdir          *ebpf.Program `ebpf:"kretp_vfs_mkdir"`
	KretpVfsRmdir          *ebpf.Program `ebpf:"kretp_vfs_rmdir"`
	TpSysEnterMkdirat      *ebpf.Program `ebpf:"tp_sys_enter_mkdirat"`
	TpSysEnterMount        *ebpf.Program `ebpf:"tp_sys_enter_mount"`
	TpSysEnterNewfstatat   *ebpf.Program `ebpf:"tp_sys_enter_newfstatat"`
	TpSysEnterUmount       *ebpf.Program `ebpf:"tp_sys_enter_umount"`
	TpSysEnterUnlinkat     *ebpf.Program `ebpf:"tp_sys_enter_unlinkat"`
	TpSysExitMkdirat       *ebpf.Program `ebpf:"tp_sys_exit_mkdirat"`
	TpSysExitMount         *ebpf.Program `ebpf:"tp_sys_exit_mount"`
	TpSysExitNewfstatat    *ebpf.Program `ebpf:"tp_sys_exit_newfstatat"`
	TpSysExitUmount        *ebpf.Program `ebpf:"tp_sys_exit_umount"`
	TpSysExitUnlinkat      *ebpf.Program `ebpf:"tp_sys_exit_unlinkat"`
}

func (p *fileopsPrograms) Close() error {
	return _FileopsClose(
		p.KpOvlWorkdirCleanup,
		p.KpOvlWorkdirCreate,
		p.KpVfsMkdir,
		p.KpVfsRmdir,
		p.KretpOvlWorkdirCleanup,
		p.KretpOvlWorkdirCreate,
		p.KretpVfsMkdir,
		p.KretpVfsRmdir,
		p.TpSysEnterMkdirat,
		p.TpSysEnterMount,
		p.TpSysEnterNewfstatat,
		p.TpSysEnterUmount,
		p.TpSysEnterUnlinkat,
		p.TpSysExitMkdirat,
		p.TpSysExitMount,
		p.TpSysExitNewfstatat,
		p.TpSysExitUmount,
		p.TpSysExitUnlinkat,
	)
}

func _FileopsClose(closers ...io.Closer) error {
	for _, closer := range closers {
		if err := closer.Close(); err != nil {
			return err
		}
	}
	return nil
}

// Do not access this directly.
//
//go:embed fileops_arm64_bpfel.o
var _FileopsBytes []byte
